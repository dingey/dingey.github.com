<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>列表</title>
    <link href="https://dingey.github.io/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://dingey.github.io/css/bootstrap-datetimepicker.min.css" rel="stylesheet">
    <link href="https://dingey.github.io/demo/summernote/summernote.css" rel="stylesheet">
    <!--[if lt IE 9]>
    <script src="https://cdn.bootcss.com/html5shiv/3.7.3/html5shiv.min.js"></script>
    <script src="https://cdn.bootcss.com/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
    <style>
        form.form-inline > .input-group, form.form-inline > label, form.form-inline > select, form.form-inline > input, form.form-inline > a, form.form-inline > button {
            margin: 5px;
        }

        .block {
            border: 1px lightgrey solid;
            padding: 20px;
            margin-top: 5px;
        }
    </style>
</head>
<body>
<div class="container block del">
    <div class="row top">
        <form class="form-inline">
            <label>标签</label>
            <select name="status" class="form-control">
                <option selected value="">下拉</option>
                <option value="1">选项1</option>
                <option value="2">选项2</option>
            </select>
            <input type="text" name="title" class="form-control" placeholder="文本">
            <div class="input-group">
                <input class="form-control date" name="date" placeholder="日期"/>
            </div>
            <a class="btn btn-primary">查询</a>
            <button type="submit" onclick="return false;" class="btn btn-default">提交</button>
            <button type="reset" class="btn btn-default">重置</button>
            <a class="btn btn-primary pull-right">新增</a>
        </form>
        <br/>
        <table class="table table-striped table-bordered table-hover table-condensed">
            <thead>
            <tr>
                <th class="index">主键</th>
                <th>序号</th>
                <th>标题</th>
                <th>操作</th>
            </tr>
            </thead>
            <tbody>
            <tr>
                <td class="id">1</td>
                <td class="index">11</td>
                <td>Slaughterhouse-Five</td>
                <td><a onclick="edit(1)" class="btn btn-primary btn-xs">编辑</a></td>
            </tr>
            </tbody>
        </table>
        <p>分页</p>
        <div class="col-xs-12 page" style="float: right">
            <a href="#" onclick="pageTo('${pageInfo.prePage}')">上一页</a>
            <a href="#" onclick="pageTo('${pageInfo.nextPage}')">下一页</a>
            ,当前第 1 页 ， 共 20 项 2 页，每页
            <select style="height: 32px;" id="pgSize" onchange="changePgSize()">
                <option value="10" selected>10</option>
                <option value="20">20</option>
                <option value="20">50</option>
            </select> 项 到第 <input type="text"
                                  style="width:48px;height: 32px;" id="pgNum"> 页
            <a class="btn btn-default" onclick="pageJunp()">GO</a>
        </div>
    </div>
    <div class="row">
        <div class="col-md-2">
            <button type="button" onclick="downCSv()" class="btn btn-info btn-lg btn-block">下载</button>
        </div>
    </div>
</div>
<div class="container">
    <div class="row">
        <div class="col-sm-12">
            <form class="form-inline" id="form">
                <input type="hidden" name="pageNum">
                <input type="hidden" name="pageSize">
            </form>
        </div>
    </div>
    <div class="row" id="container">
        <div class="col-sm-12" id="content">
        </div>
    </div>
</div>
<script src="https://dingey.github.io/js/jquery.min.js"></script>
<script src="https://dingey.github.io/js/bootstrap.min.js"></script>
<script src="https://dingey.github.io/js/moment-with-locales.js"></script>
<script src="https://dingey.github.io/js/bootstrap-datetimepicker.min.js"></script>
<script src="https://dingey.github.io/js/jquery-ui.js"></script>
<script src="https://dingey.github.io/demo/layer/layer.js"></script>
<script>
    <!-- 分页-->
    function changePgSize() {
        $("input[name='pageSize']").val($("#pgSize").val());
        pageTo();
    }
    function pageJunp() {
        pageTo($("#pgNum").val())
    }
    function pageTo(num) {
        if (num != undefined) {
            $("input[name='pageSize']").val(num);
        }
        $("#container").load("list.html #content", $("form").serialize(), function () {
            layer.msg('加载成功');
        });
    }
</script>
<script class="del">
    $(function () {
        $(".top>form>label,.top>form>select,.top>form>input,.top>form>a,.top>form>button,.top>form>.input-group").click(function () {
            var obj = $(this).clone();
            if ($(obj).hasClass("input-group")) {
                $(obj).find("div[class='bootstrap-datetimepicker-widget dropdown-menu usetwentyfour bottom']").remove();
            }
            if ($(this)[0].tagName == "SELECT") {
                layer.prompt({title: '输入多选的值以换行符分隔)', formType: 2}, function (text, index) {
                    var strs = new Array(); //定义一数组
                    strs = text.split("\n"); //字符分割
                    $(obj).empty();
                    for (var i = 0; i < strs.length; i++) {
                        $(obj).append("<option value=\"" + i + "\">" + strs[i] + "</option>");
                    }
                    layer.close(index);
                });
            } else if ($(this)[0].tagName == "LABEL") {
                layer.prompt({title: '输入标签名', formType: 0}, function (name, index) {
                    $(obj).html(name);
                    layer.close(index);
                });
            } else if ($(this)[0].tagName == "INPUT") {
                layer.prompt({title: '输入文本提示', formType: 0}, function (name, index) {
                    $(obj).attr("placeholder", name);
                    layer.close(index);
                });
            }
            $("#form").append(obj).trigger("create");
            initDate();
        });
        $(".top>table").click(function () {
            var obj = $(this).clone();
            if ($("#content>table").length > 0) {
                return false;
            }
            layer.prompt({title: '输入表格值：以*分隔列以换行符分隔行)', formType: 2}, function (text, index) {
                var strs = new Array(); //定义一数组
                strs = text.split("\n"); //字符分割
                $(obj).empty();
                var tr = "";
                for (var i = 0; i < strs.length; i++) {
                    if (i == 0) {
                        tr += "<thead><tr>";
                        for (var j = 0; j < strs[i].split("*").length; j++) {
                            tr = tr + "<th>" + strs[i].split("*")[j] + "</th>";
                        }
                        tr += "</tr></thead><tbody>";
                    } else {
                        tr += "<tr>";
                        for (var j = 0; j < strs[i].split("*").length; j++) {
                            tr = tr + "<td>" + strs[i].split("*")[j] + "</td>";
                        }
                        tr += "</tr>";
                    }
                }
                tr += "</tbody>";
                $(obj).append(tr);
                layer.close(index);
            });
            if ($("#content>.page").length < 1) {
                $("#content").append(obj).trigger("create");
            } else {
                $("#content>.page").before(obj).trigger("create");
            }
        });
        $(".top>.page").click(function () {
            var obj = $(this).clone();
            if ($("#content>.page").length > 0) {
                return false;
            }
            if ($("#content>table").length < 1) {
                $("#content").append(obj).trigger("create");
            } else {
                $("#content>table").after(obj).trigger("create");
            }
        });
    });
</script>
<script>
    function initDate() {
        $('.date').datetimepicker({
            showTodayButton: true,
            showClear: true,
            //defaultDate: "2017-11-11 11:11:11",
            locale: 'zh_CN',
            format: 'YYYY-MM-DD HH:mm:ss'
        });
    }
    $(function () {
        initDate();
    });
</script>
<script class="del">
    function downCSv(name) {
        if (name == undefined) {
            name = document.title;
        }
        var text = "";
        var html = $("html").clone();
        $(html).find(".del").remove();
        html = "<html>\n" + $(html).html() + "\n</html>";
        // 创建隐藏的可下载链接
        var eleLink = document.createElement('a');
        eleLink.download = name + ".html";
        eleLink.style.display = 'none';
        // 字符内容转变成blob地址
        var blob = new Blob([html], {type: 'text/html;charset=utf-8;'});
        eleLink.href = URL.createObjectURL(blob);
        // 触发点击
        document.body.appendChild(eleLink);
        eleLink.click();
        // 然后移除
        document.body.removeChild(eleLink);
    }
</script>
</body>
</html>
